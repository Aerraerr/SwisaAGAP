{
    "sourceFile": "app/Http/Controllers/mobile/MobileLogController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 28,
            "patches": [
                {
                    "date": 1764085786670,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764087426683,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,35 +4,40 @@\n \r\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n+use Illuminate\\Support\\Facades\\Auth;\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Get paginated login logs\r\n+     * Store a login log.\r\n      */\r\n-    public function index(Request $request)\r\n+    public function storeLoginLog(Request $request)\r\n     {\r\n-        $perPage = $request->input('per_page', 10); // Default 10 logs per page\r\n+        $user = Auth::user();\r\n \r\n-        $logs = Log::latest('activity_timestamp')->paginate($perPage);\r\n+        $userId = $user->id ?? $request->user_id;\r\n+        $userName = $user->name ?? $request->user_name ?? 'Unknown User';\r\n+        $role = $user->role ?? $request->role ?? 'Member';\r\n+        $ip = $request->ip();\r\n \r\n-        return response()->json([\r\n-            'success' => true,\r\n-            'data' => $logs\r\n+        $log = Log::create([\r\n+            'user_id' => $userId,\r\n+            'user_name' => $userName,\r\n+            'role' => $role,\r\n+            'activity' => 'Logged in',\r\n+            'ip_address' => $ip,\r\n+            'status' => 'success',\r\n+            'activity_timestamp' => now(),\r\n+            'details' => [\r\n+                'device' => $request->header('User-Agent') ?? 'Flutter App',\r\n+            ],\r\n         ]);\r\n-    }\r\n \r\n-    /**\r\n-     * Get the 5 most recent logs\r\n-     */\r\n-    public function recent()\r\n-    {\r\n-        $recentLogs = Log::latest('activity_timestamp')->take(5)->get();\r\n-\r\n         return response()->json([\r\n             'success' => true,\r\n-            'data' => $recentLogs\r\n+            'message' => 'Login logged successfully',\r\n+            'log' => $log,\r\n         ]);\r\n     }\r\n }\r\n"
                },
                {
                    "date": 1764087589479,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,18 +1,15 @@\n <?php\r\n \r\n-namespace App\\Http\\Controllers\\mobile;\r\n+namespace App\\Http\\Controllers\\mobile; // folder name must be 'mobile'\r\n \r\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n \r\n class MobileLogController extends Controller\r\n {\r\n-    /**\r\n-     * Store a login log.\r\n-     */\r\n     public function storeLoginLog(Request $request)\r\n     {\r\n         $user = Auth::user();\r\n \r\n"
                },
                {
                    "date": 1764088350698,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,40 +1,50 @@\n <?php\r\n \r\n-namespace App\\Http\\Controllers\\mobile; // folder name must be 'mobile'\r\n+namespace App\\Http\\Controllers\\mobile;\r\n \r\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n \r\n class MobileLogController extends Controller\r\n {\r\n+    /**\r\n+     * Store a login activity from Flutter mobile\r\n+     */\r\n     public function storeLoginLog(Request $request)\r\n     {\r\n-        $user = Auth::user();\r\n+        $user = Auth::user(); // If you are using Sanctum/JWT\r\n \r\n-        $userId = $user->id ?? $request->user_id;\r\n-        $userName = $user->name ?? $request->user_name ?? 'Unknown User';\r\n-        $role = $user->role ?? $request->role ?? 'Member';\r\n-        $ip = $request->ip();\r\n-\r\n         $log = Log::create([\r\n-            'user_id' => $userId,\r\n-            'user_name' => $userName,\r\n-            'role' => $role,\r\n-            'activity' => 'Logged in',\r\n-            'ip_address' => $ip,\r\n+            'user_id' => $user ? $user->id : $request->user_id ?? null,\r\n+            'user_name' => $user \r\n+                            ? ($user->first_name . ' ' . $user->last_name)\r\n+                            : ($request->user_name ?? 'Unknown'),\r\n+            'role' => $user ? $user->role : ($request->role ?? 'Guest'),\r\n+            'activity' => 'Login',\r\n+            'ip_address' => $request->ip(),\r\n             'status' => 'success',\r\n             'activity_timestamp' => now(),\r\n-            'details' => [\r\n-                'device' => $request->header('User-Agent') ?? 'Flutter App',\r\n-            ],\r\n+            'details' => $request->details ?? null,\r\n         ]);\r\n \r\n         return response()->json([\r\n             'success' => true,\r\n             'message' => 'Login logged successfully',\r\n             'log' => $log,\r\n         ]);\r\n     }\r\n+\r\n+    /**\r\n+     * Optional: fetch recent logs for Flutter if needed\r\n+     */\r\n+    public function recentLogs()\r\n+    {\r\n+        $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n+        return response()->json([\r\n+            'success' => true,\r\n+            'logs' => $recentLogs,\r\n+        ]);\r\n+    }\r\n }\r\n"
                },
                {
                    "date": 1764089428199,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,32 +11,33 @@\n {\r\n     /**\r\n      * Store a login activity from Flutter mobile\r\n      */\r\n-    public function storeLoginLog(Request $request)\r\n-    {\r\n-        $user = Auth::user(); // If you are using Sanctum/JWT\r\n+public function storeLoginLog(Request $request)\r\n+{\r\n+    $user = Auth::user(); // If using Sanctum/JWT\r\n \r\n-        $log = Log::create([\r\n-            'user_id' => $user ? $user->id : $request->user_id ?? null,\r\n-            'user_name' => $user \r\n-                            ? ($user->first_name . ' ' . $user->last_name)\r\n-                            : ($request->user_name ?? 'Unknown'),\r\n-            'role' => $user ? $user->role : ($request->role ?? 'Guest'),\r\n-            'activity' => 'Login',\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => 'success',\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n-        ]);\r\n+    $log = Log::create([\r\n+        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+        'user_name' => $user \r\n+                        ? trim($user->first_name . ' ' . $user->last_name)\r\n+                        : ($request->user_name ?? 'Unknown'),\r\n+        'role' => $user ? $user->role : ($request->role ?? 'Guest'),\r\n+        'activity' => 'Logged In', // changed\r\n+        'ip_address' => $request->ip(),\r\n+        'status' => 'success',\r\n+        'activity_timestamp' => now(),\r\n+        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n+    ]);\r\n \r\n-        return response()->json([\r\n-            'success' => true,\r\n-            'message' => 'Login logged successfully',\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n+    return response()->json([\r\n+        'success' => true,\r\n+        'message' => 'Login logged successfully',\r\n+        'log' => $log,\r\n+    ]);\r\n+}\r\n \r\n+\r\n     /**\r\n      * Optional: fetch recent logs for Flutter if needed\r\n      */\r\n     public function recentLogs()\r\n"
                },
                {
                    "date": 1764089696433,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n         'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n         'user_name' => $user \r\n                         ? trim($user->first_name . ' ' . $user->last_name)\r\n                         : ($request->user_name ?? 'Unknown'),\r\n-        'role' => $user ? $user->role : ($request->role ?? 'Guest'),\r\n+        'role' => 'Member''\r\n         'activity' => 'Logged In', // changed\r\n         'ip_address' => $request->ip(),\r\n         'status' => 'success',\r\n         'activity_timestamp' => now(),\r\n"
                },
                {
                    "date": 1764090250211,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n         'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n         'user_name' => $user \r\n                         ? trim($user->first_name . ' ' . $user->last_name)\r\n                         : ($request->user_name ?? 'Unknown'),\r\n-        'role' => 'Member''\r\n+        'role' => 'Member',\r\n         'activity' => 'Logged In', // changed\r\n         'ip_address' => $request->ip(),\r\n         'status' => 'success',\r\n         'activity_timestamp' => now(),\r\n@@ -47,5 +47,39 @@\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n+    /**\r\n+ * Store a logout activity from Flutter mobile\r\n+ */\r\n+public function storeLogoutLog(Request $request)\r\n+{\r\n+    $user = Auth::user(); // If using Sanctum/JWT\r\n+\r\n+    $log = Log::create([\r\n+        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+        'user_name' => $user \r\n+                        ? trim($user->first_name . ' ' . $user->last_name)\r\n+                        : ($request->user_name ?? 'Unknown'),\r\n+        'role' => 'Member', // you can adjust role dynamically if needed\r\n+        'activity' => 'Logged Out',\r\n+        'ip_address' => $request->ip(),\r\n+        'status' => 'success',\r\n+        'activity_timestamp' => now(),\r\n+        'details' => $request->details ?? null,\r\n+    ]);\r\n+\r\n+    // Optionally, log the user out from Laravel session / token\r\n+    if ($user) {\r\n+        Auth::logout(); // for session-based auth\r\n+        // If using Sanctum or JWT, you may revoke token here\r\n+        // $request->user()->currentAccessToken()->delete();\r\n+    }\r\n+\r\n+    return response()->json([\r\n+        'success' => true,\r\n+        'message' => 'Logout logged successfully',\r\n+        'log' => $log,\r\n+    ]);\r\n }\r\n+\r\n+}\r\n"
                },
                {
                    "date": 1764090330903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,39 +47,6 @@\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n-    /**\r\n- * Store a logout activity from Flutter mobile\r\n- */\r\n-public function storeLogoutLog(Request $request)\r\n-{\r\n-    $user = Auth::user(); // If using Sanctum/JWT\r\n-\r\n-    $log = Log::create([\r\n-        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-        'user_name' => $user \r\n-                        ? trim($user->first_name . ' ' . $user->last_name)\r\n-                        : ($request->user_name ?? 'Unknown'),\r\n-        'role' => 'Member', // you can adjust role dynamically if needed\r\n-        'activity' => 'Logged Out',\r\n-        'ip_address' => $request->ip(),\r\n-        'status' => 'success',\r\n-        'activity_timestamp' => now(),\r\n-        'details' => $request->details ?? null,\r\n-    ]);\r\n-\r\n-    // Optionally, log the user out from Laravel session / token\r\n-    if ($user) {\r\n-        Auth::logout(); // for session-based auth\r\n-        // If using Sanctum or JWT, you may revoke token here\r\n-        // $request->user()->currentAccessToken()->delete();\r\n-    }\r\n-\r\n-    return response()->json([\r\n-        'success' => true,\r\n-        'message' => 'Logout logged successfully',\r\n-        'log' => $log,\r\n-    ]);\r\n+    \r\n }\r\n-\r\n-}\r\n"
                },
                {
                    "date": 1764090381748,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,44 +9,71 @@\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store a login activity from Flutter mobile\r\n+     * Store a login or logout activity from Flutter mobile\r\n+     *\r\n+     * @param Request $request\r\n+     * @param string $action 'login' or 'logout'\r\n      */\r\n-public function storeLoginLog(Request $request)\r\n-{\r\n-    $user = Auth::user(); // If using Sanctum/JWT\r\n+    public function storeActivityLog(Request $request, string $action)\r\n+    {\r\n+        $user = Auth::user();\r\n \r\n-    $log = Log::create([\r\n-        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-        'user_name' => $user \r\n-                        ? trim($user->first_name . ' ' . $user->last_name)\r\n-                        : ($request->user_name ?? 'Unknown'),\r\n-        'role' => 'Member',\r\n-        'activity' => 'Logged In', // changed\r\n-        'ip_address' => $request->ip(),\r\n-        'status' => 'success',\r\n-        'activity_timestamp' => now(),\r\n-        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n-    ]);\r\n+        // Determine activity text\r\n+        $activity = $action === 'logout' ? 'Logged Out' : 'Logged In';\r\n \r\n-    return response()->json([\r\n-        'success' => true,\r\n-        'message' => 'Login logged successfully',\r\n-        'log' => $log,\r\n-    ]);\r\n-}\r\n+        $log = Log::create([\r\n+            'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+            'user_name' => $user\r\n+                            ? trim($user->first_name . ' ' . $user->last_name)\r\n+                            : ($request->user_name ?? 'Unknown'),\r\n+            'role' => $user ? $user->role : ($request->role ?? 'Member'),\r\n+            'activity' => $activity,\r\n+            'ip_address' => $request->ip(),\r\n+            'status' => 'success',\r\n+            'activity_timestamp' => now(),\r\n+            'details' => $request->details ?? null,\r\n+        ]);\r\n \r\n+        // Optional: logout the user if action is logout\r\n+        if ($action === 'logout' && $user) {\r\n+            Auth::logout(); // session logout\r\n+            // If using Sanctum/JWT, revoke token here\r\n+            // $request->user()->currentAccessToken()->delete();\r\n+        }\r\n \r\n+        return response()->json([\r\n+            'success' => true,\r\n+            'message' => ucfirst($action) . ' logged successfully',\r\n+            'log' => $log,\r\n+        ]);\r\n+    }\r\n+\r\n     /**\r\n-     * Optional: fetch recent logs for Flutter if needed\r\n+     * Shortcut for login\r\n      */\r\n+    public function storeLoginLog(Request $request)\r\n+    {\r\n+        return $this->storeActivityLog($request, 'login');\r\n+    }\r\n+\r\n+    /**\r\n+     * Shortcut for logout\r\n+     */\r\n+    public function storeLogoutLog(Request $request)\r\n+    {\r\n+        return $this->storeActivityLog($request, 'logout');\r\n+    }\r\n+\r\n+    /**\r\n+     * Fetch recent logs for Flutter\r\n+     */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n         return response()->json([\r\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n-    \r\n }\r\n"
                },
                {
                    "date": 1764090566014,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,9 +26,9 @@\n             'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n             'user_name' => $user\r\n                             ? trim($user->first_name . ' ' . $user->last_name)\r\n                             : ($request->user_name ?? 'Unknown'),\r\n-            'role' => $user ? $user->role : ($request->role ?? 'Member'),\r\n+            'role' =>'Member',\r\n             'activity' => $activity,\r\n             'ip_address' => $request->ip(),\r\n             'status' => 'success',\r\n             'activity_timestamp' => now(),\r\n"
                },
                {
                    "date": 1764091018104,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,71 +9,44 @@\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store a login or logout activity from Flutter mobile\r\n-     *\r\n-     * @param Request $request\r\n-     * @param string $action 'login' or 'logout'\r\n+     * Store a login activity from Flutter mobile\r\n      */\r\n-    public function storeActivityLog(Request $request, string $action)\r\n-    {\r\n-        $user = Auth::user();\r\n+public function storeLoginLog(Request $request)\r\n+{\r\n+    $user = Auth::user(); // If using Sanctum/JWT\r\n \r\n-        // Determine activity text\r\n-        $activity = $action === 'logout' ? 'Logged Out' : 'Logged In';\r\n+    $log = Log::create([\r\n+        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+        'user_name' => $user \r\n+                        ? trim($user->first_name . ' ' . $user->last_name)\r\n+                        : ($request->user_name ?? 'Unknown'),\r\n+        'role' => 'Member',\r\n+        'activity' => 'Logged In', // changed\r\n+        'ip_address' => $request->ip(),\r\n+        'status' => 'success',\r\n+        'activity_timestamp' => now(),\r\n+        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n+    ]);\r\n \r\n-        $log = Log::create([\r\n-            'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-            'user_name' => $user\r\n-                            ? trim($user->first_name . ' ' . $user->last_name)\r\n-                            : ($request->user_name ?? 'Unknown'),\r\n-            'role' =>'Member',\r\n-            'activity' => $activity,\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => 'success',\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n-        ]);\r\n+    return response()->json([\r\n+        'success' => true,\r\n+        'message' => 'Login logged successfully',\r\n+        'log' => $log,\r\n+    ]);\r\n+}\r\n \r\n-        // Optional: logout the user if action is logout\r\n-        if ($action === 'logout' && $user) {\r\n-            Auth::logout(); // session logout\r\n-            // If using Sanctum/JWT, revoke token here\r\n-            // $request->user()->currentAccessToken()->delete();\r\n-        }\r\n \r\n-        return response()->json([\r\n-            'success' => true,\r\n-            'message' => ucfirst($action) . ' logged successfully',\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n-\r\n     /**\r\n-     * Shortcut for login\r\n+     * Optional: fetch recent logs for Flutter if needed\r\n      */\r\n-    public function storeLoginLog(Request $request)\r\n-    {\r\n-        return $this->storeActivityLog($request, 'login');\r\n-    }\r\n-\r\n-    /**\r\n-     * Shortcut for logout\r\n-     */\r\n-    public function storeLogoutLog(Request $request)\r\n-    {\r\n-        return $this->storeActivityLog($request, 'logout');\r\n-    }\r\n-\r\n-    /**\r\n-     * Fetch recent logs for Flutter\r\n-     */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n         return response()->json([\r\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n+    \r\n }\r\n"
                },
                {
                    "date": 1764091080920,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,88 @@\n+<?php\r\n+\r\n+namespace App\\Http\\Controllers\\mobile;\r\n+\r\n+use App\\Http\\Controllers\\Controller;\r\n+use Illuminate\\Http\\Request;\r\n+use App\\Models\\Log;\r\n+use Illuminate\\Support\\Facades\\Auth;\r\n+\r\n+class MobileLogController extends Controller\r\n+{\r\n+    /**\r\n+     * Store a login activity from Flutter mobile\r\n+     */\r\n+    public function storeLoginLog(Request $request)\r\n+    {\r\n+        $user = Auth::user(); // If using Sanctum/JWT\r\n+\r\n+        $log = Log::create([\r\n+            'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+            'user_name' => $user \r\n+                            ? trim($user->first_name . ' ' . $user->last_name)\r\n+                            : ($request->user_name ?? 'Unknown'),\r\n+            'role' => $user ? $user->role ?? 'Member' : ($request->role ?? 'Member'),\r\n+            'activity' => 'Logged In',\r\n+            'ip_address' => $request->ip(),\r\n+            'status' => 'success',\r\n+            'activity_timestamp' => now(),\r\n+            'details' => $request->details ?? null,\r\n+        ]);\r\n+\r\n+        return response()->json([\r\n+            'success' => true,\r\n+            'message' => 'Login logged successfully',\r\n+            'log' => $log,\r\n+        ]);\r\n+    }\r\n+\r\n+    /**\r\n+     * Store a logout activity from Flutter mobile\r\n+     * Works even if the token is already deleted\r\n+     */\r\n+    public function storeLogoutLog(Request $request)\r\n+    {\r\n+        // Try to get authenticated user\r\n+        $user = Auth::user();\r\n+\r\n+        $log = Log::create([\r\n+            'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+            'user_name' => $user \r\n+                            ? trim($user->first_name . ' ' . $user->last_name)\r\n+                            : ($request->user_name ?? 'Unknown'),\r\n+            'role' => $user ? $user->role ?? 'Member' : ($request->role ?? 'Member'),\r\n+            'activity' => 'Logged Out',\r\n+            'ip_address' => $request->ip(),\r\n+            'status' => 'success',\r\n+            'activity_timestamp' => now(),\r\n+            'details' => $request->details ?? null,\r\n+        ]);\r\n+\r\n+        // If user is logged in, log them out\r\n+        if ($user) {\r\n+            Auth::logout(); // Laravel session logout\r\n+            // If using Sanctum, revoke current token\r\n+            if (method_exists($request->user(), 'currentAccessToken')) {\r\n+                $request->user()->currentAccessToken()->delete();\r\n+            }\r\n+        }\r\n+\r\n+        return response()->json([\r\n+            'success' => true,\r\n+            'message' => 'Logout logged successfully',\r\n+            'log' => $log,\r\n+        ]);\r\n+    }\r\n+\r\n+    /**\r\n+     * Optional: fetch recent logs for Flutter\r\n+     */\r\n+    public function recentLogs()\r\n+    {\r\n+        $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n+        return response()->json([\r\n+            'success' => true,\r\n+            'logs' => $recentLogs,\r\n+        ]);\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1764091208690,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,96 +11,8 @@\n {\r\n     /**\r\n      * Store a login activity from Flutter mobile\r\n      */\r\n-    public function storeLoginLog(Request $request)\r\n-    {\r\n-        $user = Auth::user(); // If using Sanctum/JWT\r\n-\r\n-        $log = Log::create([\r\n-            'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-            'user_name' => $user \r\n-                            ? trim($user->first_name . ' ' . $user->last_name)\r\n-                            : ($request->user_name ?? 'Unknown'),\r\n-            'role' => $user ? $user->role ?? 'Member' : ($request->role ?? 'Member'),\r\n-            'activity' => 'Logged In',\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => 'success',\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n-        ]);\r\n-\r\n-        return response()->json([\r\n-            'success' => true,\r\n-            'message' => 'Login logged successfully',\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n-\r\n-    /**\r\n-     * Store a logout activity from Flutter mobile\r\n-     * Works even if the token is already deleted\r\n-     */\r\n-    public function storeLogoutLog(Request $request)\r\n-    {\r\n-        // Try to get authenticated user\r\n-        $user = Auth::user();\r\n-\r\n-        $log = Log::create([\r\n-            'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-            'user_name' => $user \r\n-                            ? trim($user->first_name . ' ' . $user->last_name)\r\n-                            : ($request->user_name ?? 'Unknown'),\r\n-            'role' => $user ? $user->role ?? 'Member' : ($request->role ?? 'Member'),\r\n-            'activity' => 'Logged Out',\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => 'success',\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n-        ]);\r\n-\r\n-        // If user is logged in, log them out\r\n-        if ($user) {\r\n-            Auth::logout(); // Laravel session logout\r\n-            // If using Sanctum, revoke current token\r\n-            if (method_exists($request->user(), 'currentAccessToken')) {\r\n-                $request->user()->currentAccessToken()->delete();\r\n-            }\r\n-        }\r\n-\r\n-        return response()->json([\r\n-            'success' => true,\r\n-            'message' => 'Logout logged successfully',\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n-\r\n-    /**\r\n-     * Optional: fetch recent logs for Flutter\r\n-     */\r\n-    public function recentLogs()\r\n-    {\r\n-        $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n-        return response()->json([\r\n-            'success' => true,\r\n-            'logs' => $recentLogs,\r\n-        ]);\r\n-    }\r\n-}\r\n-<?php\r\n-\r\n-namespace App\\Http\\Controllers\\mobile;\r\n-\r\n-use App\\Http\\Controllers\\Controller;\r\n-use Illuminate\\Http\\Request;\r\n-use App\\Models\\Log;\r\n-use Illuminate\\Support\\Facades\\Auth;\r\n-\r\n-class MobileLogController extends Controller\r\n-{\r\n-    /**\r\n-     * Store a login activity from Flutter mobile\r\n-     */\r\n public function storeLoginLog(Request $request)\r\n {\r\n     $user = Auth::user(); // If using Sanctum/JWT\r\n \r\n"
                },
                {
                    "date": 1764091326099,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,41 +5,64 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n+use Illuminate\\Support\\Facades\\Hash;\r\n+use App\\Models\\User; // Assuming your User model is here\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store a login activity from Flutter mobile\r\n+     * Store login activity from Flutter mobile\r\n+     * Can log success or fail attempts\r\n      */\r\n-public function storeLoginLog(Request $request)\r\n-{\r\n-    $user = Auth::user(); // If using Sanctum/JWT\r\n+    public function storeLoginLog(Request $request)\r\n+    {\r\n+        $email = $request->email;\r\n+        $password = $request->password;\r\n \r\n-    $log = Log::create([\r\n-        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-        'user_name' => $user \r\n-                        ? trim($user->first_name . ' ' . $user->last_name)\r\n-                        : ($request->user_name ?? 'Unknown'),\r\n-        'role' => 'Member',\r\n-        'activity' => 'Logged In', // changed\r\n-        'ip_address' => $request->ip(),\r\n-        'status' => 'success',\r\n-        'activity_timestamp' => now(),\r\n-        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n-    ]);\r\n+        // Try to find the user\r\n+        $user = User::where('email', $email)->first();\r\n \r\n-    return response()->json([\r\n-        'success' => true,\r\n-        'message' => 'Login logged successfully',\r\n-        'log' => $log,\r\n-    ]);\r\n-}\r\n+        $status = 'fail';\r\n+        $activity = 'Login Failed';\r\n+        $userId = $request->user_id ?? null;\r\n+        $userName = $request->user_name ?? 'Unknown';\r\n+        $role = 'Guest';\r\n \r\n+        if ($user && Hash::check($password, $user->password)) {\r\n+            // Correct credentials\r\n+            $status = 'success';\r\n+            $activity = 'Logged In';\r\n+            $userId = $user->id;\r\n+            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n+            $role = $user->role ?? 'Member';\r\n \r\n+            // Actually login the user\r\n+            Auth::login($user);\r\n+        }\r\n+\r\n+        // Store the log\r\n+        $log = Log::create([\r\n+            'user_id' => $userId,\r\n+            'user_name' => $userName,\r\n+            'role' => $role,\r\n+            'activity' => $activity,\r\n+            'ip_address' => $request->ip(),\r\n+            'status' => $status,\r\n+            'activity_timestamp' => now(),\r\n+            'details' => $request->details ?? null,\r\n+        ]);\r\n+\r\n+        return response()->json([\r\n+            'success' => $status === 'success',\r\n+            'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n+            'log' => $log,\r\n+        ]);\r\n+    }\r\n+\r\n     /**\r\n-     * Optional: fetch recent logs for Flutter if needed\r\n+     * Fetch recent logs for Flutter\r\n      */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n@@ -47,6 +70,5 @@\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n-    \r\n }\r\n"
                },
                {
                    "date": 1764091513329,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,10 +22,10 @@\n \r\n         // Try to find the user\r\n         $user = User::where('email', $email)->first();\r\n \r\n-        $status = 'fail';\r\n-        $activity = 'Login Failed';\r\n+        $status = 'failed';\r\n+        $activity = 'Login Attempt';\r\n         $userId = $request->user_id ?? null;\r\n         $userName = $request->user_name ?? 'Unknown';\r\n         $role = 'Guest';\r\n \r\n"
                },
                {
                    "date": 1764170762141,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,9 +26,9 @@\n         $status = 'failed';\r\n         $activity = 'Login Attempt';\r\n         $userId = $request->user_id ?? null;\r\n         $userName = $request->user_name ?? 'Unknown';\r\n-        $role = 'Guest';\r\n+        $role = 'Member';\r\n \r\n         if ($user && Hash::check($password, $user->password)) {\r\n             // Correct credentials\r\n             $status = 'success';\r\n"
                },
                {
                    "date": 1764170785743,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,74 @@\n+<?php\r\n+\r\n+namespace App\\Http\\Controllers\\mobile;\r\n+\r\n+use App\\Http\\Controllers\\Controller;\r\n+use Illuminate\\Http\\Request;\r\n+use App\\Models\\Log;\r\n+use Illuminate\\Support\\Facades\\Auth;\r\n+use Illuminate\\Support\\Facades\\Hash;\r\n+use App\\Models\\User; // Assuming your User model is here\r\n+\r\n+class MobileLogController extends Controller\r\n+{\r\n+    /**\r\n+     * Store login activity from Flutter mobile\r\n+     * Can log success or fail attempts\r\n+     */\r\n+    public function storeLoginLog(Request $request)\r\n+    {\r\n+        $email = $request->email;\r\n+        $password = $request->password;\r\n+\r\n+        // Try to find the user\r\n+        $user = User::where('email', $email)->first();\r\n+\r\n+        $status = 'failed';\r\n+        $activity = 'Login Attempt';\r\n+        $userId = $request->user_id ?? null;\r\n+        $userName = $request->user_name ?? 'Unknown';\r\n+        $role = 'Member';\r\n+\r\n+        if ($user && Hash::check($password, $user->password)) {\r\n+            // Correct credentials\r\n+            $status = 'success';\r\n+            $activity = 'Logged In';\r\n+            $userId = $user->id;\r\n+            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n+            $role = $user->role ?? 'Member';\r\n+\r\n+            // Actually login the user\r\n+            Auth::login($user);\r\n+        }\r\n+\r\n+        // Store the log\r\n+        $log = Log::create([\r\n+            'user_id' => $userId,\r\n+            'user_name' => $userName,\r\n+            'role' => $role,\r\n+            'activity' => $activity,\r\n+            'ip_address' => $request->ip(),\r\n+            'status' => $status,\r\n+            'activity_timestamp' => now(),\r\n+            'details' => $request->details ?? null,\r\n+        ]);\r\n+\r\n+        return response()->json([\r\n+            'success' => $status === 'success',\r\n+            'message' => $status === 'success' ? 'Login logged successfully' : 'Login Attempt',\r\n+            'log' => $log,\r\n+        ]);\r\n+    }\r\n+\r\n+    /**\r\n+     * Fetch recent logs for Flutter\r\n+     */\r\n+    public function recentLogs()\r\n+    {\r\n+        $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n+        return response()->json([\r\n+            'success' => true,\r\n+            'logs' => $recentLogs,\r\n+        ]);\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1764170935839,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n use Illuminate\\Support\\Facades\\Hash;\r\n-use App\\Models\\User; // Assuming your User model is here\r\n+use App\\Models\\User;\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n@@ -16,95 +16,28 @@\n      * Can log success or fail attempts\r\n      */\r\n     public function storeLoginLog(Request $request)\r\n     {\r\n-        $email = $request->email;\r\n-        $password = $request->password;\r\n+        $email = $request->input('email');\r\n+        $password = $request->input('password');\r\n \r\n-        // Try to find the user\r\n-        $user = User::where('email', $email)->first();\r\n-\r\n         $status = 'failed';\r\n         $activity = 'Login Attempt';\r\n-        $userId = $request->user_id ?? null;\r\n-        $userName = $request->user_name ?? 'Unknown';\r\n+        $userId = null;\r\n+        $userName = 'Unknown';\r\n         $role = 'Member';\r\n \r\n-        if ($user && Hash::check($password, $user->password)) {\r\n-            // Correct credentials\r\n-            $status = 'success';\r\n-            $activity = 'Logged In';\r\n-            $userId = $user->id;\r\n-            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n-            $role = $user->role ?? 'Member';\r\n-\r\n-            // Actually login the user\r\n-            Auth::login($user);\r\n-        }\r\n-\r\n-        // Store the log\r\n-        $log = Log::create([\r\n-            'user_id' => $userId,\r\n-            'user_name' => $userName,\r\n-            'role' => $role,\r\n-            'activity' => $activity,\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => $status,\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n-        ]);\r\n-\r\n-        return response()->json([\r\n-            'success' => $status === 'success',\r\n-            'message' => $status === 'success' ? 'Login logged successfully' : 'Login Attempt',\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n-\r\n-    /**\r\n-     * Fetch recent logs for Flutter\r\n-     */\r\n-    public function recentLogs()\r\n-    {\r\n-        $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n-        return response()->json([\r\n-            'success' => true,\r\n-            'logs' => $recentLogs,\r\n-        ]);\r\n-    }\r\n-}\r\n-<?php\r\n-\r\n-namespace App\\Http\\Controllers\\mobile;\r\n-\r\n-use App\\Http\\Controllers\\Controller;\r\n-use Illuminate\\Http\\Request;\r\n-use App\\Models\\Log;\r\n-use Illuminate\\Support\\Facades\\Auth;\r\n-use Illuminate\\Support\\Facades\\Hash;\r\n-use App\\Models\\User; // Assuming your User model is here\r\n-\r\n-class MobileLogController extends Controller\r\n-{\r\n-    /**\r\n-     * Store login activity from Flutter mobile\r\n-     * Can log success or fail attempts\r\n-     */\r\n-    public function storeLoginLog(Request $request)\r\n-    {\r\n-        $email = $request->email;\r\n-        $password = $request->password;\r\n-\r\n         // Try to find the user\r\n         $user = User::where('email', $email)->first();\r\n \r\n-        $status = 'failed';\r\n-        $activity = 'Login Attempt';\r\n-        $userId = $request->user_id ?? null;\r\n-        $userName = $request->user_name ?? 'Unknown';\r\n-        $role = 'Member';\r\n-\r\n-        if ($user && Hash::check($password, $user->password)) {\r\n+        if (!$user) {\r\n+            $activity .= ' - User Not Found';\r\n+        } elseif (!Hash::check($password, $user->password)) {\r\n+            $activity .= ' - Wrong Password';\r\n+            $userId = $user->id; // Optional: log failed attempt for existing user\r\n+            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n+            $role = $user->role ?? 'Member';\r\n+        } else {\r\n             // Correct credentials\r\n             $status = 'success';\r\n             $activity = 'Logged In';\r\n             $userId = $user->id;\r\n@@ -128,9 +61,9 @@\n         ]);\r\n \r\n         return response()->json([\r\n             'success' => $status === 'success',\r\n-            'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n+            'message' => $status === 'success' ? 'Login successful' : $activity,\r\n             'log' => $log,\r\n         ]);\r\n     }\r\n \r\n"
                },
                {
                    "date": 1764171165118,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,48 +5,40 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n-use Illuminate\\Support\\Facades\\Hash;\r\n use App\\Models\\User;\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n      * Store login activity from Flutter mobile\r\n-     * Can log success or fail attempts\r\n+     * Make login always succeed if email exists\r\n      */\r\n     public function storeLoginLog(Request $request)\r\n     {\r\n         $email = $request->input('email');\r\n-        $password = $request->input('password');\r\n \r\n+        // Try to find the user\r\n+        $user = User::where('email', $email)->first();\r\n+\r\n         $status = 'failed';\r\n         $activity = 'Login Attempt';\r\n         $userId = null;\r\n         $userName = 'Unknown';\r\n         $role = 'Member';\r\n \r\n-        // Try to find the user\r\n-        $user = User::where('email', $email)->first();\r\n-\r\n-        if (!$user) {\r\n-            $activity .= ' - User Not Found';\r\n-        } elseif (!Hash::check($password, $user->password)) {\r\n-            $activity .= ' - Wrong Password';\r\n-            $userId = $user->id; // Optional: log failed attempt for existing user\r\n-            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n-            $role = $user->role ?? 'Member';\r\n-        } else {\r\n-            // Correct credentials\r\n+        if ($user) {\r\n+            // Force login success\r\n             $status = 'success';\r\n             $activity = 'Logged In';\r\n             $userId = $user->id;\r\n             $userName = trim($user->first_name . ' ' . $user->last_name);\r\n             $role = $user->role ?? 'Member';\r\n \r\n-            // Actually login the user\r\n-            Auth::login($user);\r\n+            Auth::login($user); // Actually log in the user\r\n+        } else {\r\n+            $activity .= ' - User Not Found';\r\n         }\r\n \r\n         // Store the log\r\n         $log = Log::create([\r\n"
                },
                {
                    "date": 1764171236703,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,63 +5,41 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n-use App\\Models\\User;\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store login activity from Flutter mobile\r\n-     * Make login always succeed if email exists\r\n+     * Store a login activity from Flutter mobile\r\n      */\r\n-    public function storeLoginLog(Request $request)\r\n-    {\r\n-        $email = $request->input('email');\r\n+public function storeLoginLog(Request $request)\r\n+{\r\n+    $user = Auth::user(); // If using Sanctum/JWT\r\n \r\n-        // Try to find the user\r\n-        $user = User::where('email', $email)->first();\r\n+    $log = Log::create([\r\n+        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+        'user_name' => $user \r\n+                        ? trim($user->first_name . ' ' . $user->last_name)\r\n+                        : ($request->user_name ?? 'Unknown'),\r\n+        'role' => 'Member',\r\n+        'activity' => 'Logged In', // changed\r\n+        'ip_address' => $request->ip(),\r\n+        'status' => 'success',\r\n+        'activity_timestamp' => now(),\r\n+        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n+    ]);\r\n \r\n-        $status = 'failed';\r\n-        $activity = 'Login Attempt';\r\n-        $userId = null;\r\n-        $userName = 'Unknown';\r\n-        $role = 'Member';\r\n+    return response()->json([\r\n+        'success' => true,\r\n+        'message' => 'Login logged successfully',\r\n+        'log' => $log,\r\n+    ]);\r\n+}\r\n \r\n-        if ($user) {\r\n-            // Force login success\r\n-            $status = 'success';\r\n-            $activity = 'Logged In';\r\n-            $userId = $user->id;\r\n-            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n-            $role = $user->role ?? 'Member';\r\n \r\n-            Auth::login($user); // Actually log in the user\r\n-        } else {\r\n-            $activity .= ' - User Not Found';\r\n-        }\r\n-\r\n-        // Store the log\r\n-        $log = Log::create([\r\n-            'user_id' => $userId,\r\n-            'user_name' => $userName,\r\n-            'role' => $role,\r\n-            'activity' => $activity,\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => $status,\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n-        ]);\r\n-\r\n-        return response()->json([\r\n-            'success' => $status === 'success',\r\n-            'message' => $status === 'success' ? 'Login successful' : $activity,\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n-\r\n     /**\r\n-     * Fetch recent logs for Flutter\r\n+     * Optional: fetch recent logs for Flutter if needed\r\n      */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n@@ -69,5 +47,6 @@\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n+    \r\n }\r\n"
                },
                {
                    "date": 1764171381706,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,41 +5,64 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n+use Illuminate\\Support\\Facades\\Hash;\r\n+use App\\Models\\User; // Assuming your User model is here\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store a login activity from Flutter mobile\r\n+     * Store login activity from Flutter mobile\r\n+     * Can log success or fail attempts\r\n      */\r\n-public function storeLoginLog(Request $request)\r\n-{\r\n-    $user = Auth::user(); // If using Sanctum/JWT\r\n+    public function storeLoginLog(Request $request)\r\n+    {\r\n+        $email = $request->email;\r\n+        $password = $request->password;\r\n \r\n-    $log = Log::create([\r\n-        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-        'user_name' => $user \r\n-                        ? trim($user->first_name . ' ' . $user->last_name)\r\n-                        : ($request->user_name ?? 'Unknown'),\r\n-        'role' => 'Member',\r\n-        'activity' => 'Logged In', // changed\r\n-        'ip_address' => $request->ip(),\r\n-        'status' => 'success',\r\n-        'activity_timestamp' => now(),\r\n-        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n-    ]);\r\n+        // Try to find the user\r\n+        $user = User::where('email', $email)->first();\r\n \r\n-    return response()->json([\r\n-        'success' => true,\r\n-        'message' => 'Login logged successfully',\r\n-        'log' => $log,\r\n-    ]);\r\n-}\r\n+        $status = 'fail';\r\n+        $activity = 'Login Failed';\r\n+        $userId = $request->user_id ?? null;\r\n+        $userName = $request->user_name ?? 'Unknown';\r\n+        $role = 'Guest';\r\n \r\n+        if ($user && Hash::check($password, $user->password)) {\r\n+            // Correct credentials\r\n+            $status = 'success';\r\n+            $activity = 'Logged In';\r\n+            $userId = $user->id;\r\n+            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n+            $role = $user->role ?? 'Member';\r\n \r\n+            // Actually login the user\r\n+            Auth::login($user);\r\n+        }\r\n+\r\n+        // Store the log\r\n+        $log = Log::create([\r\n+            'user_id' => $userId,\r\n+            'user_name' => $userName,\r\n+            'role' => $role,\r\n+            'activity' => $activity,\r\n+            'ip_address' => $request->ip(),\r\n+            'status' => $status,\r\n+            'activity_timestamp' => now(),\r\n+            'details' => $request->details ?? null,\r\n+        ]);\r\n+\r\n+        return response()->json([\r\n+            'success' => $status === 'success',\r\n+            'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n+            'log' => $log,\r\n+        ]);\r\n+    }\r\n+\r\n     /**\r\n-     * Optional: fetch recent logs for Flutter if needed\r\n+     * Fetch recent logs for Flutter\r\n      */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n@@ -47,6 +70,5 @@\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n-    \r\n }\r\n"
                },
                {
                    "date": 1764171420241,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,64 +5,41 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n-use Illuminate\\Support\\Facades\\Hash;\r\n-use App\\Models\\User; // Assuming your User model is here\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store login activity from Flutter mobile\r\n-     * Can log success or fail attempts\r\n+     * Store a login activity from Flutter mobile\r\n      */\r\n-    public function storeLoginLog(Request $request)\r\n-    {\r\n-        $email = $request->email;\r\n-        $password = $request->password;\r\n+public function storeLoginLog(Request $request)\r\n+{\r\n+    $user = Auth::user(); // If using Sanctum/JWT\r\n \r\n-        // Try to find the user\r\n-        $user = User::where('email', $email)->first();\r\n+    $log = Log::create([\r\n+        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+        'user_name' => $user \r\n+                        ? trim($user->first_name . ' ' . $user->last_name)\r\n+                        : ($request->user_name ?? 'Unknown'),\r\n+        'role' => 'Member',\r\n+        'activity' => 'Logged In', // changed\r\n+        'ip_address' => $request->ip(),\r\n+        'status' => 'success',\r\n+        'activity_timestamp' => now(),\r\n+        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n+    ]);\r\n \r\n-        $status = 'fail';\r\n-        $activity = 'Login Failed';\r\n-        $userId = $request->user_id ?? null;\r\n-        $userName = $request->user_name ?? 'Unknown';\r\n-        $role = 'Guest';\r\n+    return response()->json([\r\n+        'success' => true,\r\n+        'message' => 'Login logged successfully',\r\n+        'log' => $log,\r\n+    ]);\r\n+}\r\n \r\n-        if ($user && Hash::check($password, $user->password)) {\r\n-            // Correct credentials\r\n-            $status = 'success';\r\n-            $activity = 'Logged In';\r\n-            $userId = $user->id;\r\n-            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n-            $role = $user->role ?? 'Member';\r\n \r\n-            // Actually login the user\r\n-            Auth::login($user);\r\n-        }\r\n-\r\n-        // Store the log\r\n-        $log = Log::create([\r\n-            'user_id' => $userId,\r\n-            'user_name' => $userName,\r\n-            'role' => $role,\r\n-            'activity' => $activity,\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => $status,\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n-        ]);\r\n-\r\n-        return response()->json([\r\n-            'success' => $status === 'success',\r\n-            'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n-\r\n     /**\r\n-     * Fetch recent logs for Flutter\r\n+     * Optional: fetch recent logs for Flutter if needed\r\n      */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n@@ -70,5 +47,6 @@\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n+    \r\n }\r\n"
                },
                {
                    "date": 1764171504132,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,41 +5,64 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n+use Illuminate\\Support\\Facades\\Hash;\r\n+use App\\Models\\User; // Assuming your User model is here\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store a login activity from Flutter mobile\r\n+     * Store login activity from Flutter mobile\r\n+     * Can log success or fail attempts\r\n      */\r\n-public function storeLoginLog(Request $request)\r\n-{\r\n-    $user = Auth::user(); // If using Sanctum/JWT\r\n+    public function storeLoginLog(Request $request)\r\n+    {\r\n+        $email = $request->email;\r\n+        $password = $request->password;\r\n \r\n-    $log = Log::create([\r\n-        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-        'user_name' => $user \r\n-                        ? trim($user->first_name . ' ' . $user->last_name)\r\n-                        : ($request->user_name ?? 'Unknown'),\r\n-        'role' => 'Member',\r\n-        'activity' => 'Logged In', // changed\r\n-        'ip_address' => $request->ip(),\r\n-        'status' => 'success',\r\n-        'activity_timestamp' => now(),\r\n-        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n-    ]);\r\n+        // Try to find the user\r\n+        $user = User::where('email', $email)->first();\r\n \r\n-    return response()->json([\r\n-        'success' => true,\r\n-        'message' => 'Login logged successfully',\r\n-        'log' => $log,\r\n-    ]);\r\n-}\r\n+        $status = 'failed';\r\n+        $activity = 'Login Attempt';\r\n+        $userId = $request->user_id ?? null;\r\n+        $userName = $request->user_name ?? 'Unknown';\r\n+        $role = 'Guest';\r\n \r\n+        if ($user && Hash::check($password, $user->password)) {\r\n+            // Correct credentials\r\n+            $status = 'success';\r\n+            $activity = 'Logged In';\r\n+            $userId = $user->id;\r\n+            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n+            $role = $user->role ?? 'Member';\r\n \r\n+            // Actually login the user\r\n+            Auth::login($user);\r\n+        }\r\n+\r\n+        // Store the log\r\n+        $log = Log::create([\r\n+            'user_id' => $userId,\r\n+            'user_name' => $userName,\r\n+            'role' => $role,\r\n+            'activity' => $activity,\r\n+            'ip_address' => $request->ip(),\r\n+            'status' => $status,\r\n+            'activity_timestamp' => now(),\r\n+            'details' => $request->details ?? null,\r\n+        ]);\r\n+\r\n+        return response()->json([\r\n+            'success' => $status === 'success',\r\n+            'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n+            'log' => $log,\r\n+        ]);\r\n+    }\r\n+\r\n     /**\r\n-     * Optional: fetch recent logs for Flutter if needed\r\n+     * Fetch recent logs for Flutter\r\n      */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n@@ -47,6 +70,5 @@\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n-    \r\n }\r\n"
                },
                {
                    "date": 1764171681345,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,61 +14,46 @@\n     /**\r\n      * Store login activity from Flutter mobile\r\n      * Can log success or fail attempts\r\n      */\r\n-    public function storeLoginLog(Request $request)\r\n-    {\r\n-        $email = $request->email;\r\n-        $password = $request->password;\r\n+public function storeLoginLog(Request $request)\r\n+{\r\n+    $userId = $request->input('user_id');\r\n+    $details = $request->input('details') ?? null;\r\n \r\n-        // Try to find the user\r\n-        $user = User::where('email', $email)->first();\r\n+    $user = User::find($userId);\r\n \r\n-        $status = 'failed';\r\n-        $activity = 'Login Attempt';\r\n-        $userId = $request->user_id ?? null;\r\n-        $userName = $request->user_name ?? 'Unknown';\r\n-        $role = 'Guest';\r\n+    $status = 'failed';\r\n+    $activity = 'Login Attempt';\r\n+    $userName = 'Unknown';\r\n+    $role = 'Member';\r\n \r\n-        if ($user && Hash::check($password, $user->password)) {\r\n-            // Correct credentials\r\n-            $status = 'success';\r\n-            $activity = 'Logged In';\r\n-            $userId = $user->id;\r\n-            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n-            $role = $user->role ?? 'Member';\r\n+    if ($user) {\r\n+        // Log in the user directly\r\n+        Auth::login($user);\r\n+        $status = 'success';\r\n+        $activity = 'Logged In';\r\n+        $userName = trim($user->first_name . ' ' . $user->last_name);\r\n+        $role = $user->role ?? 'Member';\r\n+    } else {\r\n+        $activity .= ' - User Not Found';\r\n+    }\r\n \r\n-            // Actually login the user\r\n-            Auth::login($user);\r\n-        }\r\n+    $log = Log::create([\r\n+        'user_id' => $userId,\r\n+        'user_name' => $userName,\r\n+        'role' => $role,\r\n+        'activity' => $activity,\r\n+        'ip_address' => $request->ip(),\r\n+        'status' => $status,\r\n+        'activity_timestamp' => now(),\r\n+        'details' => $details,\r\n+    ]);\r\n \r\n-        // Store the log\r\n-        $log = Log::create([\r\n-            'user_id' => $userId,\r\n-            'user_name' => $userName,\r\n-            'role' => $role,\r\n-            'activity' => $activity,\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => $status,\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n-        ]);\r\n+    return response()->json([\r\n+        'success' => $status === 'success',\r\n+        'message' => $status === 'success' ? 'Login successful' : $activity,\r\n+        'log' => $log,\r\n+    ]);\r\n+}\r\n \r\n-        return response()->json([\r\n-            'success' => $status === 'success',\r\n-            'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n-\r\n-    /**\r\n-     * Fetch recent logs for Flutter\r\n-     */\r\n-    public function recentLogs()\r\n-    {\r\n-        $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n-        return response()->json([\r\n-            'success' => true,\r\n-            'logs' => $recentLogs,\r\n-        ]);\r\n-    }\r\n }\r\n"
                },
                {
                    "date": 1764171742545,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,55 +5,48 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n-use Illuminate\\Support\\Facades\\Hash;\r\n-use App\\Models\\User; // Assuming your User model is here\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store login activity from Flutter mobile\r\n-     * Can log success or fail attempts\r\n+     * Store a login activity from Flutter mobile\r\n      */\r\n public function storeLoginLog(Request $request)\r\n {\r\n-    $userId = $request->input('user_id');\r\n-    $details = $request->input('details') ?? null;\r\n+    $user = Auth::user(); // If using Sanctum/JWT\r\n \r\n-    $user = User::find($userId);\r\n-\r\n-    $status = 'failed';\r\n-    $activity = 'Login Attempt';\r\n-    $userName = 'Unknown';\r\n-    $role = 'Member';\r\n-\r\n-    if ($user) {\r\n-        // Log in the user directly\r\n-        Auth::login($user);\r\n-        $status = 'success';\r\n-        $activity = 'Logged In';\r\n-        $userName = trim($user->first_name . ' ' . $user->last_name);\r\n-        $role = $user->role ?? 'Member';\r\n-    } else {\r\n-        $activity .= ' - User Not Found';\r\n-    }\r\n-\r\n     $log = Log::create([\r\n-        'user_id' => $userId,\r\n-        'user_name' => $userName,\r\n-        'role' => $role,\r\n-        'activity' => $activity,\r\n+        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n+        'user_name' => $user \r\n+                        ? trim($user->first_name . ' ' . $user->last_name)\r\n+                        : ($request->user_name ?? 'Unknown'),\r\n+        'role' => 'Member',\r\n+        'activity' => 'Logged In', // changed\r\n         'ip_address' => $request->ip(),\r\n-        'status' => $status,\r\n+        'status' => 'success',\r\n         'activity_timestamp' => now(),\r\n-        'details' => $details,\r\n+        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n     ]);\r\n \r\n     return response()->json([\r\n-        'success' => $status === 'success',\r\n-        'message' => $status === 'success' ? 'Login successful' : $activity,\r\n+        'success' => true,\r\n+        'message' => 'Login logged successfully',\r\n         'log' => $log,\r\n     ]);\r\n }\r\n \r\n+\r\n+    /**\r\n+     * Optional: fetch recent logs for Flutter if needed\r\n+     */\r\n+    public function recentLogs()\r\n+    {\r\n+        $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n+        return response()->json([\r\n+            'success' => true,\r\n+            'logs' => $recentLogs,\r\n+        ]);\r\n+    }\r\n+    \r\n }\r\n"
                },
                {
                    "date": 1764171857266,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,41 +5,64 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n+use Illuminate\\Support\\Facades\\Hash;\r\n+use App\\Models\\User; // Assuming your User model is here\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store a login activity from Flutter mobile\r\n+     * Store login activity from Flutter mobile\r\n+     * Can log success or fail attempts\r\n      */\r\n-public function storeLoginLog(Request $request)\r\n-{\r\n-    $user = Auth::user(); // If using Sanctum/JWT\r\n+    public function storeLoginLog(Request $request)\r\n+    {\r\n+        $email = $request->email;\r\n+        $password = $request->password;\r\n \r\n-    $log = Log::create([\r\n-        'user_id' => $user ? $user->id : ($request->user_id ?? null),\r\n-        'user_name' => $user \r\n-                        ? trim($user->first_name . ' ' . $user->last_name)\r\n-                        : ($request->user_name ?? 'Unknown'),\r\n-        'role' => 'Member',\r\n-        'activity' => 'Logged In', // changed\r\n-        'ip_address' => $request->ip(),\r\n-        'status' => 'success',\r\n-        'activity_timestamp' => now(),\r\n-        'details' => $request->details ?? null, // make sure Flutter sends null if empty\r\n-    ]);\r\n+        // Try to find the user\r\n+        $user = User::where('email', $email)->first();\r\n \r\n-    return response()->json([\r\n-        'success' => true,\r\n-        'message' => 'Login logged successfully',\r\n-        'log' => $log,\r\n-    ]);\r\n-}\r\n+        $status = 'failed';\r\n+        $activity = 'Login Attempt';\r\n+        $userId = $request->user_id ?? null;\r\n+        $userName = $request->user_name ?? 'Unknown';\r\n+        $role = 'Guest';\r\n \r\n+        if ($user && Hash::check($password, $user->password)) {\r\n+            // Correct credentials\r\n+            $status = 'success';\r\n+            $activity = 'Logged In';\r\n+            $userId = $user->id;\r\n+            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n+            $role = $user->role ?? 'Member';\r\n \r\n+            // Actually login the user\r\n+            Auth::login($user);\r\n+        }\r\n+\r\n+        // Store the log\r\n+        $log = Log::create([\r\n+            'user_id' => $userId,\r\n+            'user_name' => $userName,\r\n+            'role' => $role,\r\n+            'activity' => $activity,\r\n+            'ip_address' => $request->ip(),\r\n+            'status' => $status,\r\n+            'activity_timestamp' => now(),\r\n+            'details' => $request->details ?? null,\r\n+        ]);\r\n+\r\n+        return response()->json([\r\n+            'success' => $status === 'success',\r\n+            'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n+            'log' => $log,\r\n+        ]);\r\n+    }\r\n+\r\n     /**\r\n-     * Optional: fetch recent logs for Flutter if needed\r\n+     * Fetch recent logs for Flutter\r\n      */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n@@ -47,6 +70,5 @@\n             'success' => true,\r\n             'logs' => $recentLogs,\r\n         ]);\r\n     }\r\n-    \r\n }\r\n"
                },
                {
                    "date": 1764172066810,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,40 +5,30 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n-use Illuminate\\Support\\Facades\\Hash;\r\n-use App\\Models\\User; // Assuming your User model is here\r\n+use App\\Models\\User;\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n      * Store login activity from Flutter mobile\r\n-     * Can log success or fail attempts\r\n+     * Uses user_id from Flutter login\r\n      */\r\n     public function storeLoginLog(Request $request)\r\n     {\r\n-        $email = $request->email;\r\n-        $password = $request->password;\r\n+        $userId = $request->input('user_id');\r\n+        $userName = $request->input('user_name') ?? 'Unknown';\r\n+        $role = $request->input('role') ?? 'Member';\r\n+        $status = $request->input('status') === 'success' ? 'success' : 'failed';\r\n+        $details = $request->input('details') ?? null;\r\n \r\n-        // Try to find the user\r\n-        $user = User::where('email', $email)->first();\r\n+        $activity = $status === 'success' ? 'Logged In' : 'Login Attempt';\r\n \r\n-        $status = 'failed';\r\n-        $activity = 'Login Attempt';\r\n-        $userId = $request->user_id ?? null;\r\n-        $userName = $request->user_name ?? 'Unknown';\r\n-        $role = 'Guest';\r\n+        $user = User::find($userId);\r\n \r\n-        if ($user && Hash::check($password, $user->password)) {\r\n-            // Correct credentials\r\n-            $status = 'success';\r\n-            $activity = 'Logged In';\r\n-            $userId = $user->id;\r\n-            $userName = trim($user->first_name . ' ' . $user->last_name);\r\n-            $role = $user->role ?? 'Member';\r\n-\r\n-            // Actually login the user\r\n+        if ($user && $status === 'success') {\r\n+            // Optionally, log the user in on server side (for Sanctum session)\r\n             Auth::login($user);\r\n         }\r\n \r\n         // Store the log\r\n@@ -49,9 +39,9 @@\n             'activity' => $activity,\r\n             'ip_address' => $request->ip(),\r\n             'status' => $status,\r\n             'activity_timestamp' => now(),\r\n-            'details' => $request->details ?? null,\r\n+            'details' => $details,\r\n         ]);\r\n \r\n         return response()->json([\r\n             'success' => $status === 'success',\r\n"
                },
                {
                    "date": 1764172200627,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,52 +5,56 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n-use App\\Models\\User;\r\n+use Illuminate\\Support\\Facades\\Hash;\r\n+use App\\Models\\User; // Assuming your User model is here\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n      * Store login activity from Flutter mobile\r\n-     * Uses user_id from Flutter login\r\n+     * Can log success or fail attempts\r\n      */\r\n-    public function storeLoginLog(Request $request)\r\n-    {\r\n-        $userId = $request->input('user_id');\r\n-        $userName = $request->input('user_name') ?? 'Unknown';\r\n-        $role = $request->input('role') ?? 'Member';\r\n-        $status = $request->input('status') === 'success' ? 'success' : 'failed';\r\n-        $details = $request->input('details') ?? null;\r\n+public function storeLoginLog(Request $request)\r\n+{\r\n+    $userId = $request->input('user_id');\r\n+    $userName = $request->input('user_name') ?? 'Unknown';\r\n+    $role = $request->input('role') ?? 'Member';\r\n+    $details = $request->input('details') ?? null;\r\n \r\n-        $activity = $status === 'success' ? 'Logged In' : 'Login Attempt';\r\n+    $user = User::find($userId);\r\n \r\n-        $user = User::find($userId);\r\n+    if ($user) {\r\n+        $status = 'success';\r\n+        $activity = 'Logged In';\r\n \r\n-        if ($user && $status === 'success') {\r\n-            // Optionally, log the user in on server side (for Sanctum session)\r\n-            Auth::login($user);\r\n-        }\r\n+        // Optional: login user on server side\r\n+        Auth::login($user);\r\n+    } else {\r\n+        $status = 'failed';\r\n+        $activity = 'Login Attempt';\r\n+    }\r\n \r\n-        // Store the log\r\n-        $log = Log::create([\r\n-            'user_id' => $userId,\r\n-            'user_name' => $userName,\r\n-            'role' => $role,\r\n-            'activity' => $activity,\r\n-            'ip_address' => $request->ip(),\r\n-            'status' => $status,\r\n-            'activity_timestamp' => now(),\r\n-            'details' => $details,\r\n-        ]);\r\n+    $log = Log::create([\r\n+        'user_id' => $userId,\r\n+        'user_name' => $userName,\r\n+        'role' => $role,\r\n+        'activity' => $activity,\r\n+        'ip_address' => $request->ip(),\r\n+        'status' => $status,\r\n+        'activity_timestamp' => now(),\r\n+        'details' => $details,\r\n+    ]);\r\n \r\n-        return response()->json([\r\n-            'success' => $status === 'success',\r\n-            'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n-            'log' => $log,\r\n-        ]);\r\n-    }\r\n+    return response()->json([\r\n+        'success' => $status === 'success',\r\n+        'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n+        'log' => $log,\r\n+    ]);\r\n+}\r\n \r\n+\r\n     /**\r\n      * Fetch recent logs for Flutter\r\n      */\r\n     public function recentLogs()\r\n"
                },
                {
                    "date": 1764172466514,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,58 +5,56 @@\n use App\\Http\\Controllers\\Controller;\r\n use Illuminate\\Http\\Request;\r\n use App\\Models\\Log;\r\n use Illuminate\\Support\\Facades\\Auth;\r\n-use Illuminate\\Support\\Facades\\Hash;\r\n-use App\\Models\\User; // Assuming your User model is here\r\n+use App\\Models\\User;\r\n \r\n class MobileLogController extends Controller\r\n {\r\n     /**\r\n-     * Store login activity from Flutter mobile\r\n-     * Can log success or fail attempts\r\n+     * Store only successful login activity from Flutter\r\n      */\r\n-public function storeLoginLog(Request $request)\r\n-{\r\n-    $userId = $request->input('user_id');\r\n-    $userName = $request->input('user_name') ?? 'Unknown';\r\n-    $role = $request->input('role') ?? 'Member';\r\n-    $details = $request->input('details') ?? null;\r\n+    public function storeLoginLog(Request $request)\r\n+    {\r\n+        $userId = $request->input('user_id');\r\n+        $userName = $request->input('user_name') ?? 'Unknown';\r\n+        $role = $request->input('role') ?? 'Member';\r\n+        $details = $request->input('details') ?? null;\r\n \r\n-    $user = User::find($userId);\r\n+        $user = User::find($userId);\r\n \r\n-    if ($user) {\r\n-        $status = 'success';\r\n-        $activity = 'Logged In';\r\n+        // Only log if user exists\r\n+        if ($user) {\r\n+            $log = Log::create([\r\n+                'user_id' => $userId,\r\n+                'user_name' => $userName,\r\n+                'role' => $role,\r\n+                'activity' => 'Logged In',\r\n+                'ip_address' => $request->ip(),\r\n+                'status' => 'success',\r\n+                'activity_timestamp' => now(),\r\n+                'details' => $details,\r\n+            ]);\r\n \r\n-        // Optional: login user on server side\r\n-        Auth::login($user);\r\n-    } else {\r\n-        $status = 'failed';\r\n-        $activity = 'Login Attempt';\r\n-    }\r\n+            // Optional: log in user server-side\r\n+            Auth::login($user);\r\n \r\n-    $log = Log::create([\r\n-        'user_id' => $userId,\r\n-        'user_name' => $userName,\r\n-        'role' => $role,\r\n-        'activity' => $activity,\r\n-        'ip_address' => $request->ip(),\r\n-        'status' => $status,\r\n-        'activity_timestamp' => now(),\r\n-        'details' => $details,\r\n-    ]);\r\n+            return response()->json([\r\n+                'success' => true,\r\n+                'message' => 'Login logged successfully',\r\n+                'log' => $log,\r\n+            ]);\r\n+        }\r\n \r\n-    return response()->json([\r\n-        'success' => $status === 'success',\r\n-        'message' => $status === 'success' ? 'Login logged successfully' : 'Login failed',\r\n-        'log' => $log,\r\n-    ]);\r\n-}\r\n+        // Do not log failed attempts\r\n+        return response()->json([\r\n+            'success' => false,\r\n+            'message' => 'User not found, login not logged',\r\n+        ]);\r\n+    }\r\n \r\n-\r\n     /**\r\n-     * Fetch recent logs for Flutter\r\n+     * Fetch recent logs\r\n      */\r\n     public function recentLogs()\r\n     {\r\n         $recentLogs = Log::latest('activity_timestamp')->take(10)->get();\r\n"
                }
            ],
            "date": 1764085786670,
            "name": "Commit-0",
            "content": "<?php\r\n\r\nnamespace App\\Http\\Controllers\\mobile;\r\n\r\nuse App\\Http\\Controllers\\Controller;\r\nuse Illuminate\\Http\\Request;\r\nuse App\\Models\\Log;\r\n\r\nclass MobileLogController extends Controller\r\n{\r\n    /**\r\n     * Get paginated login logs\r\n     */\r\n    public function index(Request $request)\r\n    {\r\n        $perPage = $request->input('per_page', 10); // Default 10 logs per page\r\n\r\n        $logs = Log::latest('activity_timestamp')->paginate($perPage);\r\n\r\n        return response()->json([\r\n            'success' => true,\r\n            'data' => $logs\r\n        ]);\r\n    }\r\n\r\n    /**\r\n     * Get the 5 most recent logs\r\n     */\r\n    public function recent()\r\n    {\r\n        $recentLogs = Log::latest('activity_timestamp')->take(5)->get();\r\n\r\n        return response()->json([\r\n            'success' => true,\r\n            'data' => $recentLogs\r\n        ]);\r\n    }\r\n}\r\n"
        }
    ]
}