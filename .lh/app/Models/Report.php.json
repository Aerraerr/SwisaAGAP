{
    "sourceFile": "app/Models/Report.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1764012340029,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764012600398,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,47 +6,57 @@\n use App\\Models\\Training;\n \n class Report\n {\n-    /**\n-     * Total registered participants\n-     */\n     public static function totalRegisteredParticipants()\n     {\n         return Participant::count();\n     }\n \n-    /**\n-     * Total checked-in participants\n-     */\n     public static function totalCheckedIn()\n     {\n         return Participant::whereNotNull('check_in_at')->count();\n     }\n \n-    /**\n-     * Average event attendance (%) = checked-in / registered\n-     */\n+    public static function totalQRScanned()\n+    {\n+        return Participant::where('qr_scanned', 1)->count();\n+    }\n+\n     public static function averageEventAttendance()\n     {\n         $total = self::totalRegisteredParticipants();\n         $checkedIn = self::totalCheckedIn();\n-\n-        if ($total === 0) {\n-            return 0;\n-        }\n-\n-        return round(($checkedIn / $total) * 100, 2);\n+        return $total > 0 ? round(($checkedIn / $total) * 100, 2) : 0;\n     }\n \n-    /**\n-     * Most attended training name\n-     */\n     public static function mostAttendedTraining()\n     {\n         $training = Training::withCount('participants')\n             ->orderByDesc('participants_count')\n             ->first();\n \n-        return $training ? $training->title : null;\n+        return $training ? [\n+            'title' => $training->title,\n+            'participants' => $training->participants_count\n+        ] : null;\n     }\n+\n+    public static function trainingBreakdown()\n+    {\n+        return Training::withCount('participants')\n+            ->withCount(['participants as checked_in_count' => function($q) {\n+                $q->whereNotNull('check_in_at');\n+            }])\n+            ->get()\n+            ->map(function ($t) {\n+                return [\n+                    'title' => $t->title,\n+                    'total_participants' => $t->participants_count,\n+                    'checked_in' => $t->checked_in_count,\n+                    'attendance_rate' => $t->participants_count > 0 \n+                        ? round(($t->checked_in_count / $t->participants_count) * 100, 2)\n+                        : 0\n+                ];\n+            });\n+    }\n }\n"
                },
                {
                    "date": 1764155939401,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,62 @@\n+<?php\n+\n+namespace App\\Models;\n+\n+use App\\Models\\Participant;\n+use App\\Models\\Training;\n+\n+class Report\n+{\n+    public static function totalRegisteredParticipants()\n+    {\n+        return Participant::count();\n+    }\n+\n+    public static function totalCheckedIn()\n+    {\n+        return Participant::whereNotNull('check_in_at')->count();\n+    }\n+\n+    public static function totalQRScanned()\n+    {\n+        return Participant::where('qr_scanned', 1)->count();\n+    }\n+\n+    public static function averageEventAttendance()\n+    {\n+        $total = self::totalRegisteredParticipants();\n+        $checkedIn = self::totalCheckedIn();\n+        return $total > 0 ? round(($checkedIn / $total) * 100, 2) : 0;\n+    }\n+\n+    public static function mostAttendedTraining()\n+    {\n+        $training = Training::withCount('participants')\n+            ->orderByDesc('participants_count')\n+            ->first();\n+\n+        return $training ? [\n+            'title' => $training->title,\n+            'participants' => $training->participants_count\n+        ] : null;\n+    }\n+\n+    public static function trainingBreakdown()\n+    {\n+        return Training::withCount('participants')\n+            ->withCount(['participants as checked_in_count' => function($q) {\n+                $q->whereNotNull('check_in_at');\n+            }])\n+            ->get()\n+            ->map(function ($t) {\n+                return [\n+                    'title' => $t->title,\n+                    'total_participants' => $t->participants_count,\n+                    'checked_in' => $t->checked_in_count,\n+                    'attendance_rate' => $t->participants_count > 0 \n+                        ? round(($t->checked_in_count / $t->participants_count) * 100, 2)\n+                        : 0\n+                ];\n+            });\n+    }\n+}\n"
                }
            ],
            "date": 1764012340029,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Models;\n\nuse App\\Models\\Participant;\nuse App\\Models\\Training;\n\nclass Report\n{\n    /**\n     * Total registered participants\n     */\n    public static function totalRegisteredParticipants()\n    {\n        return Participant::count();\n    }\n\n    /**\n     * Total checked-in participants\n     */\n    public static function totalCheckedIn()\n    {\n        return Participant::whereNotNull('check_in_at')->count();\n    }\n\n    /**\n     * Average event attendance (%) = checked-in / registered\n     */\n    public static function averageEventAttendance()\n    {\n        $total = self::totalRegisteredParticipants();\n        $checkedIn = self::totalCheckedIn();\n\n        if ($total === 0) {\n            return 0;\n        }\n\n        return round(($checkedIn / $total) * 100, 2);\n    }\n\n    /**\n     * Most attended training name\n     */\n    public static function mostAttendedTraining()\n    {\n        $training = Training::withCount('participants')\n            ->orderByDesc('participants_count')\n            ->first();\n\n        return $training ? $training->title : null;\n    }\n}\n"
        }
    ]
}